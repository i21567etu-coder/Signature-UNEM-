<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ - Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„ÙˆØ·Ù†ÙŠ</title>
    <!-- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…ÙƒØªØ¨Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ù„ÙØ§Øª PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <!-- Ø®Ø·ÙˆØ· Ø¬ÙˆØ¬Ù„ Ù„Ù…Ø¸Ù‡Ø± Ø§Ø­ØªØ±Ø§ÙÙŠ -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Cairo', sans-serif; 
            background-color: #f0f2f5; 
            margin: 0; 
            padding: 0; 
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between; /* Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø¹Ù„Ù‰ ÙˆØ§Ù„Ø£Ø³ÙÙ„ */
            min-height: 100vh;
        }

        .container { 
            background: white; 
            padding: 40px; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
            width: 90%; 
            max-width: 500px;
            text-align: center;
            margin-top: 50px; /* Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ */
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø´Ø¹Ø§Ø± */
        .site-logo { 
            width: 100px; 
            margin-bottom: 20px; 
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
        }
        
        h1 { color: #006400; font-size: 24px; margin-bottom: 10px; }
        p { color: #555; margin-bottom: 30px; font-size: 15px; line-height: 1.6; }
        
        /* Ø²Ø± Ø§Ù„Ø±ÙØ¹ */
        .upload-btn {
            background: linear-gradient(135deg, #006400, #004d00);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 100, 0, 0.3);
            width: 100%;
            box-sizing: border-box;
        }
        .upload-btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(0, 100, 0, 0.4);
        }
        
        #pdfInput { display: none; }
        
        /* Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .download-btn {
            display: none; /* Ù…Ø®ÙÙŠ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
            margin-top: 25px;
            background: linear-gradient(135deg, #d32f2f, #b71c1c);
            color: white;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            box-sizing: border-box;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(211, 47, 47, 0.3);
        }
        .download-btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(211, 47, 47, 0.4);
        }

        .status { margin-top: 20px; font-weight: bold; font-size: 14px; min-height: 20px; }
        .loading { color: #f57c00; }
        .success { color: #006400; }
        .error { color: #d32f2f; }

        /* =========================================
           ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ°ÙŠÙŠÙ„ (Footer) Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ ÙˆØ§Ù„Ù…Ø¶ÙŠØ¡
           ========================================= */
        footer {
            width: 100%;
            background-color: #1a1a1a; /* Ø®Ù„ÙÙŠØ© Ø¯Ø§ÙƒÙ†Ø© */
            padding: 20px 0;
            text-align: center;
            margin-top: auto; /* ÙŠØ¯ÙØ¹Ù‡ Ù„Ù„Ø£Ø³ÙÙ„ Ø¯Ø§Ø¦Ù…Ø§Ù‹ */
            border-top: 3px solid #006400; /* Ø®Ø· Ø£Ø®Ø¶Ø± Ø±ÙÙŠØ¹ */
            box-shadow: 0 -10px 20px rgba(0,0,0,0.1);
        }

        .footer-text {
            font-family: 'Segoe UI', sans-serif;
            font-size: 14px;
            color: #888;
            letter-spacing: 1px;
        }

        .dev-name {
            font-weight: bold;
            color: #fff;
            text-transform: uppercase;
            margin-right: 5px;
            /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© (Glow Effect) */
            text-shadow: 
                0 0 5px #fff,
                0 0 10px #00ffcc,
                0 0 20px #00ffcc,
                0 0 40px #00ffcc;
            animation: neon-pulse 2s infinite alternate;
        }

        @keyframes neon-pulse {
            0% { text-shadow: 0 0 5px #fff, 0 0 10px #00ffcc, 0 0 20px #00ffcc; }
            100% { text-shadow: 0 0 2px #fff, 0 0 5px #00ffcc, 0 0 10px #00ffcc; opacity: 0.9; }
        }

    </style>
</head>
<body>

    <div class="container">
        <!-- Ø§Ù„Ø´Ø¹Ø§Ø± -->
        <img src="logo.png" class="site-logo" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø§ØªØ­Ø§Ø¯" onerror="this.style.display='none'">
        
        <h1>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹</h1>
        <p>Ù…Ù†ØµØ© ÙˆØ¶Ø¹ Ø§Ù„Ø®ØªÙ… Ø§Ù„Ø¢Ù„ÙŠ Ø¹Ù„Ù‰ Ù…Ù„ÙØ§Øª PDF <br> Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„ÙˆØ·Ù†ÙŠ Ù„Ø·Ù„Ø¨Ø© Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§</p>

        <!-- Ø²Ø± Ø§Ù„Ø±ÙØ¹ -->
        <label for="pdfInput" class="upload-btn">
            <span>ğŸ“„</span>
            <span>Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù PDF</span>
        </label>
        <input type="file" id="pdfInput" accept="application/pdf" onchange="processPDF()">

        <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© -->
        <div id="status-msg" class="status"></div>

        <!-- Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ (ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©) -->
        <a id="download-link" class="download-btn" href="#" download>
            ğŸ“¥ Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹
        </a>
    </div>

    <!-- Ø§Ù„ØªØ°ÙŠÙŠÙ„ Ø§Ù„Ù…Ø¶ÙŠØ¡ -->
    <footer>
        <div class="footer-text">
            DÃ©veloppÃ© par <span class="dev-name">Mohamed Dah Agove</span>
        </div>
    </footer>

    <script>
        async function processPDF() {
            const fileInput = document.getElementById('pdfInput');
            const statusMsg = document.getElementById('status-msg');
            const downloadLink = document.getElementById('download-link');
            const file = fileInput.files[0];

            if (!file) return;

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            downloadLink.style.display = 'none';
            statusMsg.innerText = "â³ Ø¬Ø§Ø±ÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ø®ØªÙ…ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...";
            statusMsg.className = "status loading";

            try {
                // 1. Ø¬Ù„Ø¨ Ø§Ù„Ø´Ø¹Ø§Ø± Ù…Ù† GitHub Pages
                const logoResponse = await fetch('logo.png');
                if (!logoResponse.ok) throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ logo.png");
                const logoImageBytes = await logoResponse.arrayBuffer();

                // 2. Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø±ÙÙˆØ¹
                const pdfBytes = await file.arrayBuffer();

                // 3. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø©
                const { PDFDocument } = PDFLib;
                const pdfDoc = await PDFDocument.load(pdfBytes);

                // 4. Ø¯Ù…Ø¬ Ø§Ù„ØµÙˆØ±Ø© (Ù…Ø­Ø§ÙˆÙ„Ø© PNG Ø«Ù… JPG)
                let logoImage;
                try {
                    logoImage = await pdfDoc.embedPng(logoImageBytes);
                } catch (e) {
                    logoImage = await pdfDoc.embedJpg(logoImageBytes);
                }

                // 5. Ø¶Ø¨Ø· Ø§Ù„Ø­Ø¬Ù… ÙˆØ§Ù„Ù…ÙƒØ§Ù† (Ù…Ù†ØªØµÙ Ø§Ù„ØµÙØ­Ø©)
                const logoDims = logoImage.scale(0.5);
                const pages = pdfDoc.getPages();

                for (const page of pages) {
                    const { width, height } = page.getSize();
                    page.drawImage(logoImage, {
                        x: (width - logoDims.width) / 2,
                        y: (height - logoDims.height) / 2,
                        width: logoDims.width,
                        height: logoDims.height,
                        opacity: 0.15, // Ø§Ù„Ø´ÙØ§ÙÙŠØ©
                    });
                }

                // 6. Ø§Ù„Ø­ÙØ¸ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø·
                const modifiedPdfBytes = await pdfDoc.save();
                const blob = new Blob([modifiedPdfBytes], { type: 'application/pdf' });
                const blobUrl = URL.createObjectURL(blob);

                // 7. Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„ØªÙ†Ø²ÙŠÙ„
                downloadLink.href = blobUrl;
                downloadLink.download = file.name.replace('.pdf', '_signed.pdf');
                downloadLink.style.display = 'inline-block'; // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø²Ø±
                
                statusMsg.innerText = "âœ… ØªÙ… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¨Ù†Ø¬Ø§Ø­! Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø£Ø¯Ù†Ø§Ù‡ Ù„Ù„ØªØ­Ù…ÙŠÙ„";
                statusMsg.className = "status success";

            } catch (err) {
                console.error(err);
                statusMsg.innerText = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£: ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ù„Ù logo.png";
                statusMsg.className = "status error";
            }
        }
    </script>
</body>
</html>